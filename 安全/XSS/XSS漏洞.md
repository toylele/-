# XSS漏洞

## 01、XSS漏洞原理及防范

### 1.1、XSS漏洞原理

​	XSS全称(Cross Site Scripting）跨站脚本攻击，是最常见的Web应用程序安全漏洞之一，位于OWASP top 10 2013年度第三名XSS是指攻击者在网页中嵌入客户端脚本，通常是JavaScript编写的危险代码，当用户使用浏览器浏览网页时，脚本就会在用户的浏览器上执行，从而达到攻击者的目的。

​	XSS属于客户端攻击，受害者最终是用户，但特别要注意的是网站管理人员也属于用户之一。这就意味着XSS可以进行“服务端”攻击，因为管理员要比普通用户的权限大得多，一般管理员都可以对网站进行文件管理，数据管理等操作，而攻击者一般也是靠管理员身份作为“跳板”进行实施攻击。

​	XSS攻击最终目的是在网页中嵌入客户端恶意脚本代码，最常用的攻击代码是javascript语言，但也会使用其它的脚本语言，例如:ActionScript、VBscript。而如今的互联网客户端脚本基本是基于Javascript,所以如果想要深入研究XSS，必须要精通Javascript。

​	XSS换句话说，JavaScript能做到什么效果，XSS的胃里就有多大。这完全不是危言耸听。javascript可以用来获取用户的cookie，弹出窗口，那么存在XSS漏洞的网站，XSS就可以用来盗取用户Cookie,废掉页面，导航到恶意网站!更高端的XSS代码完全可以进行监控你的键盘操作，模仿Windows注销界面，诱导你输入开机密码!而攻击者需要做的仅仅是向你的代码中注入Javascript代码!

![image-20241023102536039](\typora-user-images\image-20241023102536039.png)https://github.com/toylele/-/blob/e2065d4ffe42b9e16acd4881d47bbfc6f469a0db/typora-user-images/image-20240926140328894.png
XSS的重点不在于跨站点，而在于脚本的执行。那么XSS的原理是:

​	恶意攻击者在web页面中会插入一些恶意的script代码当用户浏览该页面的时候，那么嵌入到web页面中script代码会执行，因此会达到恶意攻击用户的目的。那么攻击最主要有如下分类:反射型、存储型、及DOM-based型。反射性和DOM-baseed型可以归类为非持久性XSS攻击。存储型可以归类为持久性XSS攻击。

### 1.2、XSS漏洞出现的原因

程序对输入和输出的控制不够严格,导致"精心构造“的脚本输入后,在输到前端时被浏览器当作有效代码解析执行从而产生危害.

### 1.3、XSS的危害

​	1、首先对于那些半年没有更新的小企业网站来说，发生XSS漏洞几乎没有什么用。一般在各类的社交平台，邮件系统，开源流行的Web应用，BBS，微博等场景中，造成的杀伤力却十分强大。
​	2、劫持用户cookie是最常见的跨站攻击形式，通过在网页中写入并执行脚本执行文件（多数情况下是JavaScript脚本代码)，劫持用户浏览器，将用户当前使用的sessionlD信息发送至攻击者控制的网站或服务器中。
​	3、“框架钓鱼”。利用JS脚本的基本功能之一:操作网页中的DOM树结构和内容，在网页中通过JS脚本，生成虚假的页面，欺骗用户执行操作，而用户所有的输入内容都会被发送到攻击者的服务器上。
​	4、挂马(水坑攻击)5、有局限性的键盘记录

### 1.4、XSS的分类

​	1、反射型XSS或不持久型×SS(中危)心
​	2、储存型XSS 或持久型XSS(高危)
​	3.DOM XSS

### 1.5、XSS测试方法

​	1、工具扫描:APPscan、Awvs
​	2、手工测试: Burpsuite、firefox(hackbar)、XSSER XSSF
​	使用手工检测Web应用程序是否存在XSS漏洞时，最重要的是考虑那里有输入，输入的数据在什么地方输出。在进行手工检测XSS时，人毕竟不像软件那样不知疲惫，所以一定要选择有特殊意义的字符，这样可以快速测试是否存在XSS。
​		(1）在目标站点上找到输入点,比如查询接口,留言板等;
​		(2）输入一组"特殊字符+唯一识别字符",点击提交后,查看返回的源码,是否有做对应的处理;
​		(3)通过搜索定位到唯一字符,结合唯一字符前后语法确认是否可以构造执行js的条件(构造闭合);提交构造的脚本代码,看是否可以成功执行,如果成功执行则说明存在XSS漏洞;

## 02、反射型XSS

### 2.1说明

​	反射型xss攻击( Reflected XSS)又称为非持久性跨站点脚本攻击，它是最常见的类型的XSS。漏洞产生的原因是攻击者注入的数据反映在响应中
一个典型的非持久性XSS
包含一个带XSS攻击向量的链接(即每次攻击需要用户的点击)

```shell
#JS相关说明
JavaScript是互联网上最流行的脚本语言，这门语言可用于HTML和web，更可广泛用于服务器、PC、笔记本电脑、平板电脑和智能手机等设备。JavaScript是一种轻量级的编程语言。
JavaScript是可插入HTML页面的编程代码。
JavaScript插入HTML页面后，可由所有的现代浏览器执行。

#Javascript语法格式:
<script>[Javascript代码]</script>

```

​	DOM型XSS:

​	通过JavaScript，以里.小看西炸得对HTML文档中所有元素进行访问的入面的某个东西进行操作时，JavaScript就需要获得对HTML文
口。这个入口就是DOM，所以在DOM型的xss漏洞利用中，DOM可以看成是一个访问HTML的标准程序接口。
特征:整个过程都是在前端完成的，没有后端的参与（纯前端的操作! )

## 03、存储型XSS
